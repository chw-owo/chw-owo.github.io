---
title: Packet 02) Packet Serialization
categories: RookissGameServer
tags: 
toc: true
toc_sticky: true
---

이 포스트는 Rookiss님의 \<C++과 언리얼로 만드는 MMORPG 게임 개발 시리즈 Part4:  게임 서버> 수업을 바탕으로 공부한 내용을 정리한 것입니다. 

# **1. 임시 객체를 경유하는 방법**

패킷에서 포인터로 저장되는 값은 네트워크로 직접 전달할 경우 아무 의미 없는 값이 된다. 따라서 이러한 데이터들은 하나씩 직렬로 저장하여 받는 측에서 사용할 수 있도록 만들어야 한다. 이러한 과정을 두고 패킷 직렬화, Packet Serialization이라고 부른다.

위와 같이 데이터가 저장된 offset과 size를 저장한 뒤 맨 뒤에 가변 데이터를 직렬로 이어붙이면 받는 측에서 offset과 size를 이용해  데이터에 접근할 수 있다. 아래 예제는 이렇게 데이터를 송수신 하되, 데이터를 가져올 때 임시 객체를 생성하여 복사를 통해 가져온다. 

```c++

```

<br/> 

# **2. 데이터에 직접 접근하는 방법**

위 방법은 저장을 위한 임시 객체를 만들고 이를 복사한다. 이때 아래 예제와 같이 Helper 함수를 만들 경우, 임시 객체 생성과 복사 과정을 생략하고 데이터를 직접 꺼내서 사용할 수 있다. 또, 이 경우 iterator 인터페이스를 구현함으로써 간편하게 쓰도록 할 수 있다. 

```c++

```

<br/> 

# **3. 버퍼에 데이터를 바로 넣는 방법**

데이터를 불러와서 저장하는 대신 버퍼에 바로 넣을 수도 있다. 이 예제는 가변길이 데이터 Buff 안에 또 다른 가변길이 데이터 victim이 들어있다. 이때도 동일하게 Reserve를 이용해서 전달하는데, 이중으로 가변 길이 데이터가 나올 때마다 이 과정을 거치기 때문에 코드가 다소 지져분해진다. 

```c++

```

<br/>

# **출처**

[C++과 언리얼로 만드는 MMORPG 게임 개발 시리즈] Part4: 게임 서버, Rookiss
