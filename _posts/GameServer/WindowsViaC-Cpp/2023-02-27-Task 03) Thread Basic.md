---
title: Task 03) Thread Basic
categories: WindowsViaC-Cpp
tags: 
toc: true
toc_sticky: true
---

이 포스트는 <제프리 리처의 Windows via C/C++ (한빛미디어)> 내용을 바탕으로 공부한 내용을 정리한 것입니다. 

# **1. 스레드**

## **1) 스레드란?**

프로세스는 스스로 어떤 것도 수행할 수 없으며, 단순하게 생각한다면 스레드들의 저장소로 볼 수도 있다. 스레드는 프로세스 주소 공간 내의 코드를 실제로 수행하는 주체가 된다. 스레드는 항상 프로세스의 컨텍스트 내에서 생성되어 프로세스 내에서만 살아있는다. 하나의 프로세스에 다수의 스레드가 존재할 경우 스레드들은 단일 주소 공간을 공유하며 커널 오브젝트 핸들 역시 공유하게 된다. 

프로세스의 초기화가 진행되는 동안 시스템은 주 스레드를 생성하며, 마이크로소프트 C/C++ 컴파일러로 작성한 경우 주 스레드가 C/C++ 런타임 라이브러리의 시작코드를 수행하게 된다. 이후 진입점 함수 (main 함수)를 호출하고 함수가 반환될 때까지 수행을 계속하다가 반환되면 C/C++ 런타임 라이브러리의 시작 코드가 ExitProcess를 호출하며 수행을 종료한다. 

프로세스는 자신만의 주소 공간을 가지므로 스레드에 비해 더 많은 시스템 리소스를 사용한다. 프로세스는 상당량의 정보를 시스템 내부에 저장하기 때문에 메모리를 많이 필요로 하며, .exe, .dll 파일이 주소 공간으로 로드되어야 하므로 파일 리소스 또한 필요하다. 반면 스레드는 상당히 적은 시스템 리소스를 필요로 하는데, 하나의 커널 오브젝트와 스레드 스택만을 요구한다.

스레드는 스레드는 운영체제가 스레드를 다루기 위해 사용하는 스레드 커널 오브젝트와 스레드가 코드를 수행할 때 매개변수 및 지역 변수를 저장하기 위해 사용하는 스레드 스택으로 구성된다. 이때 스레드 커널 오브젝트는 시스템이 스레드에 대한 통계 정보를 저장하는 공간이기도 하다. 따라서 시스템 내부에 저장해두는 내용도 적고 메모리도 덜 차지한다.

이처럼 스레드는 프로세스에 비해 부하가 적기 때문에 프로세스를 새로 생성하는 대신 추가적인 스레드를 생성하여 해결하는 것이 더 효율적인 경우가 많다. 반면, 반대로 여러개의 프로세스를 사용하는 것이 더 효율적인 상황 역시 존재한다. 각각의 예시는 아래와 같다.  

## **2) 스레드를 생성해야 하는 경우**


## **3) 스레드를 생성하지 말아야 하는 경우**

<br/>

# **2. 스레드 생성**

## **1) 처음으로 작성하는 스레드 함수**

## **2)  CreateThread 함수**

<br/>

# **3. 스레드 종료**

## **1)**

<br/>

# **4. 스레드 내부 구조**

## **1)**


<br/>

# **5. C/C++ 런타임 라이브러리**

## **1)**

<br/>

# **6. 구분자 얻기**

## **1)**

<br/>