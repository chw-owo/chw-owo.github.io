---
title: Procademy, Assignment 10) Cracking
categories: ProcademyAssignment
tags: 
toc: true
toc_sticky: true
---

# **과제**

**1.** 숫자 값을 입력받아 지정된 값과 비교하는 exe 실행파일을 visual studio 디버거의 디스어셈블리로 확인하여 지정된 값을 알아내기

**2.** 위 exe 실행파일의 지정된 값을 헥사 에디터를 이용해 0으로 크래킹하기

**3.** 정수 3개를 입력 받아 특정 연산들을 거친 후 출력해주는 exe 실행파일을 디스어셈블리로 확인하여 어떤 연산을 수행하는지 알아내기

<br/>

# **과제 풀이 방법**

어셈블리어를 분석하여 찾아내면 되는 과제였다. 처음에 과제를 받았을 때는 어디부터 어디까지 분석해야 되는지 몰라서 살짝 막막했으나, 비교 연산을 비롯한 연산들을 실행하기 위해서는 우선 레지스터에 해당 데이터를 올려야 된다는 것을 고려하니 금방 풀 수 있었다. 레지스터 창을 켜두고 레지스터 중 하나가 내가 입력한 숫자로 바뀔 때까지 F11을 누르다가 바뀌는 것을 확인하고 나면 그 인근부터 어셈블리어를 분석하는 식으로 범위를 좁혔다. 

<br/>

# **과제 결과**

**1.**

```
81 7D F8 64 35 00 00     cmp dword ptr [ebp-8],3564h
```
위 코드가 패스워드를 검사하는 부분으로, 패스워드는 16진수로 3564, 10진수로 13668입니다.

**2** 
```
81 7D F8 64 35 00 00    cmp dword ptr [ebp-8],3564h
```
```
81 7D F8 00 00 00 00    cmp dword ptr [ebp-8],0h
```
위와 같이 3564에 해당하는 숫자를 0으로 바꿔주면 0을 입력했을 때 통과하는 실행 파일이 됩니다. 

**3.**

```
8B 45 F4                mov  eax,dword ptr [ebp-0Ch]
```
여기서 ebp-0Ch는 첫번째 input으로, eax에 첫번째 input이 들어갑니다.

```
03 45 F8                add  eax,dword ptr [ebp-8]
```
ebp-8은 두번째 input으로, eax에 두번째 input을 더합니다.

```
C1 E0 03                shl   eax,3
```
첫번째 input과 두번째 input을 더한 값을 3번 left shift 합니다. 

```
2B 45 F8                sub   eax,dword ptr [ebp-8]
```

위의 값에서 다시 두번째 input을 뺍니다. 그 후 해당 결과를 스택에 저장했다가 출력합니다. 세번째 input은 사용되지 않았습니다. 

<br/>

# **과제 해설**

호출 스택을 확인하면 더 쉽게 해결할 수 있었다. dll로 라이브러리를 링크할 경우 현재 스택이 라이브러리 함수의 스택인지, 사용자가 적은 함수의 스택인지 확인할 수 있다. 호출 스택에 crt를 비롯한 dll 관련 부분을 스킵하고 **실행파일.exe.함수이름()** 부분부터 확인하면 실행 파일 main 로직을 바로 확인할 수 있다. 일부 다른 디버거에서는 이 영역을 직접 찾아주기도 한다. 
dll이 아니라 static lib를 사용할 경우 호출스택에서 구분할 수 없게 되는데 이런 경우에는 내가 사용한 방법을 활용해도 좋을 것 같다. 
