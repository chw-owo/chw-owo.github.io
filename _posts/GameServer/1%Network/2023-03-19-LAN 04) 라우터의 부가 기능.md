---
title: LAN 04) 라우터의 부가 기능
categories: 1%Network
tags: 
toc: true
toc_sticky: true
---

이 포스트는 Tsutomu tone의 <성공과 실패를 결정하는 1%의 네트워크 원리(성안당)> 내용을 바탕으로 공부한 내용을 정리한 것입니다. 

# **1. 주소 변환**

주소는 각 기기를 식별하는 것이므로 중복되면 안되나, 인터넷 사용자가 늘어나면서 주소 부족의 위험에 처했다. 이에 대처하기 위해 기존의 고유한 주소는 글로벌 주소로 지칭하고 회사와 같이 특정 집단 내에서만 사용하는 주소는 프라이빗 주소로 지칭하며, 특정 집단 내에서만 사용되는 주소들은 각 집단들이 중복하여 사용할 수 있도록 했다. 

프라이빗 주소 기기도 인터넷을 사용하도록 하기 위해서는 사내 네트워크를 인터넷 공개 서버 접속 부분과 사내용 네트워크 두가지로 나누어 공개용 서버에만 글로벌 주소를 할당한다. 이때, 사내 네트워크에는 인터넷과 직접 패킷을 주고 받지 않도록 특별한 구조를 사용해 접속하는데 이 구조를 주소 변환이라고 한다. 

주소 변환의 기본 구조는 패킷을 중계할 때 IP 헤더에 기재된 IP 주소와 포트번호를 바꾸어 쓰는 것이다. 인터넷 측 포트번호에 글로벌 주소를 할당해두고 인터넷에 중계할 때는 송신처 IP 주소를 이 값으로 바꾸도록 한 것이다. 포트 번호는 미사용 번호를 주소 변환 장치가 적당히 선택하여 사용한 후, 바뀌기 전의 값과 바꾼 후의 값을 쌍으로 묶어 주소 변환 장치 내부에 기록해둔다. 

송신처 IP 주소 및 포트 번호를 바꿔쓴 후 송출하고 이에 대한 회신 패킷이 돌아오면 주소 변환 장치 대응표를 바탕으로 사내 네트워크에 패킷을 보낼 것이다. 그리고 접속 동작이 끝나면 대응표에 등록한 것을 삭제한다. 이런 방법을 통해 프라이빗 주소를 가진 기기로도 인터넷에 접속할 수 있다. 가정에서의 LAN도 동일한 방법으로 동작한다. 

IP 주소는 이미 할당되어 있고, 포트 번호는 비어있는 것을 쓰기 때문에 사내에서 인터넷으로 중계할 때는 대응표가 없어도 문제가 없다. 그러나 인터넷에서 사내로 중계할 때는 대응표가 없으면 찾아갈 수 없다. 이는 인터넷에 엑세스하지 않은 기기는 수동으로 대응표를 등록하지 않는 이상 인터넷에서 송신할 수 없다는 뜻이다. 이를 통해 부정 침입을 방지할 수도 있다. 

<br/>

# **2. 패킷 필터링**

패킷 필터링도 중요한 부가 기능 중 하나이다. 이는 패킷을 중계할 때 MAC 헤더, IP 헤더, TCP 헤더에 기록된 내용을 조사하여, 사전에 설정된 조건에 합치하면 중계 혹은 폐기하는 것이다. 대부분의 방화벽은 이 원리를 이용해 부정 침입을 방지한다. 